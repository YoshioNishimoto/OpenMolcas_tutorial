# 演習01

せっかくなので、もう少し実際的な課題を提示して、それに対処するような形にしてみましょう。
というわけで、Bergman環化と呼ばれる反応について詳しく見てみましょう。

<img src="https://github.com/YoshioNishimoto/sandbox/blob/figure/ex01_01.png" width="768">

上の反応で、reactant、transition state (TS)、productをそれぞれSS-CASSCF (single-state CASSCF)を使って分子の構造最適化をして、
それからギブズエネルギー（298.15 K）を計算してみましょう。

とは言え、結果の確認のためにはある程度手法を固定しておかなければなりません。
`&GATEWAY`は次のような感じにしています。

```
&GATEWAY
  Coord = input.xyz
  Basis = 6-31G*
  Group = Full
  NoCD
```

- `Coord`は外部からXYZファイルを読み込むようにしていますが、あらわに元素と座標を貼り付けても構いません。
- エネルギーが合うかの確認のため、`Basis`はこれにしてください。
- `Group`を使うようにしましょう。reactantとTSは$`C_\mathrm{2v}`$、productは$`D_\mathrm{2h}`$となるようにしましょう。一部の計算では`Group = C1`でないといけないかもしれない（未定）ので、その都度記載します。
- Cholesky分解を使うとHessianが解析的に計算できないので、今回は`NoCD`にします。

また、Hartree–Fockで構造最適化した構造をex01のディレクトリに置いておきます。
条件をそろえても、すべての桁まで一致するとは限らないです。
少なくとも4桁ぐらいは一致するかなと思いますが。

## 01. Hartree–Fock法による計算(1)

まずは、与えられた構造を用いてHartree–Fock法を用いて構造最適化してみましょう。
正しく計算ができていれば、1サイクル目で計算が終了するはずです。


## 02. Hartree–Fock法による計算(2)

次に、構造最適化した構造（与えられた構造でも良いです）を用いて、基準振動解析をしてみましょう。
その名の通り、分子の基準振動の固有値（波数）や固有ベクトル（基準振動モード）を計算し、
その結果を用いて零点振動補正やギブズエネルギーへの補正を計算することが目的となります。
というわけで、次のような感じで`&MCKINLEY`（と`&MCLR`）というモジュールを使います。

```
&GATEWAY
  Coord = reactant.Opt.xyz
  Basis = 6-31G*
  Group = Full
  NoCD

&SEWARD

&SCF

&MCKINLEY
```

すると、例えばreactantの結果として

```
    Symmetry a1 
   ==============

                        1         2         3         4         5         6

     Frequency:        i0.13    119.62    494.84    808.85    933.70   1353.77     

     Intensity:    3.611E-09 1.218E-01 8.708E+00 2.843E+01 8.459E+00 7.616E-02
     Red. mass:      7.60311   4.43907   5.36847   1.30502   6.29496   1.09780

     C1         x    0.00001   0.33355  -0.01052  -0.08497  -0.16022  -0.01538
     C1         y    0.31623   0.13133  -0.12530  -0.06423   0.19866   0.01556

```
のような感じになると思います。
これはreactantの基準振動（ここでは既約表現A<sub>1</sub>のもの）を計算して、結果として波数（単位はcm<sup>–1</sup>）がほぼゼロ[^1]になっています。
波数がゼロになるというのはポテンシャルエネルギー面が限りなくフラットということに対応しており、
この振動に対してエネルギーが変わらないということに対応しています。
今回の計算では、ほぼゼロとなる振動が他の既約表現のものを含めて6つ見えており、これらは並進と回転に対応しています（`*.freq.molden`で可視化してみましょう）。

熱力学解析は、まずは次の部分です。
```
 Number of trans. and rot. degrees of freedom:  6
 ZPVE                48.444 kcal/mol      0.077201 au.
 ZPVE corrected energy                 -229.305424 au.
```
零点エネルギーの補正が`0.0772101 au.`であると言っています。
零点補正されたエネルギーは、もともとのエネルギー（`-229.38262545`）に`0.077201`を足した`-229.305424 au.`になるようです。
計算の方法は物理化学の教科書参照。

零点エネルギーは内部エネルギーへの補正ですが、
エントロピーの寄与は温度に依存します。
ここでは298.15 Kということにしておきましょう。
```
 *****************************************************
 Temperature =   298.15 Kelvin, Pressure =   1.00 atm
 -----------------------------------------------------
 Molecular Partition Function and Molar Entropy:
                        q/V (M**-3)    S(kcal/mol*K)
 Electronic            1.000000E+00        0.000
 Translational         2.028342E+28       38.901
 Rotational            1.478707E+05       26.637
 Vibrational           2.055513E-35        9.734
 TOTAL                 6.165148E-02       75.272

 Thermal contributions to INTERNAL ENERGY:
 Electronic           0.000 kcal/mol      0.000000 au.
 Translational        0.889 kcal/mol      0.001416 au.
 Rotational           0.889 kcal/mol      0.001416 au.
 Vibrational         50.224 kcal/mol      0.080037 au.
 TOTAL               52.001 kcal/mol      0.082870 au.

 Thermal contributions to
 ENTHALPY            52.594 kcal/mol      0.083814 au.
 GIBBS FREE ENERGY   30.152 kcal/mol      0.048050 au.

 Sum of energy and thermal contributions
 INTERNAL ENERGY                       -229.299756 au.
 ENTHALPY                              -229.298812 au.
 GIBBS FREE ENERGY                     -229.334576 au.
 -----------------------------------------------------
```
計算の方法等は物理化学の教科書参照。
ここでのギブズエネルギーは`-229.334576 au.`となります。
Hartree–Fock法の計算として得られるエネルギーは`-229.38262545` (au)なので、
ギブズエネルギーによる補正（すなわち零点エネルギー、並進・回転、$`PV`$項、エントロピー）により+0.048050 au程度エネルギーが増えるようです。
今回、相対エネルギーを計算する際はこのギブズエネルギーを用いてください。

なお、ここでのギブズエネルギーというのは理想気体的で剛体モデルを用いて、さらに調和振動子近似を用いています。
ポテンシャルエネルギー面の極値でないと調和振動子近似が使えないので、構造最適化をしたあとで`&MCKINLEY`をする必要があります。

productとTSの計算をすると、3つの虚振動が見えるため、この構造は三次の鞍点（あんてん）[^2]に対応します。
このため、得られた構造はポテンシャルエネルギー面上での極小値やTSではないわけです。
これはおそらくHartree–Fockだからで、CASSCFの計算では極小・TSとなるはずです。

||SCF energy|Gibbs free energy|$`\Delta G`$|
|-|-|-|-|
|reactant|-229.38262545|-229.334576|0.00|
|TS|-229.27063299|-229.227300|+67.32|
|product|-229.27089982|-229.226784|+67.64|

$`\Delta E`$的にはTSよりもproductの方が安定ですが、$`\Delta G`$的にはproductの方が不安定となってしまいます。
たまにあります。

## 03. CASSCF

まずは活性空間を定義しなければいけません。
このとき、いくつか考慮しなければならない点があります。
- 基本的にはπ共役をしている分子は、できる限り全てのπ軌道を活性空間に入れます
- productにはH原子をもたないC原子があり、これらはn軌道を持ちますので、
- この反応でσ結合が新しくできるため、この結合に関与する軌道を活性空間に入れなければいけない
- 最終的にproductを$`D_\mathrm{2h}`$の構造にしたいので、結合の生成に関与しないけれど等価な軌道も活性空間に入れないといけない（結合ができる位置が2位と3位であるとすると、5位と6位のあいだのσ結合も含める）
これらを考慮して活性空間を作りましょう。

（必ずしもこれが正解というわけではないですが）

---

[^1]: 計算上厳密にゼロになることはまずないです。目安というものは特にないですが、このぐらいの計算であれば、波数の絶対値が10 cm<sup>–1</sup>未満になって欲しいなと思います。
[^2]: 三次の遷移状態とは言わない。遷移状態は一次の鞍点にしか用いない。
