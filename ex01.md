# 演習01

せっかくなので、もう少し実際的な課題に対処するような形にしてみましょう。
というわけで、Bergman環化と呼ばれる反応について詳しく見てみましょう。

<center><img src="https://github.com/YoshioNishimoto/sandbox/blob/figure/ex01_01.png" width="512"></center>
<center><b>Fig. 1</b> Bergman cyclization</center>

（中央揃えにならないのですが）

<br>
上の反応で、reactant、transition state (TS)、productをそれぞれSS-CASSCF (single-state CASSCF)を使って分子の構造最適化をして、
それからギブズエネルギー（298.15 K）を計算してみましょう。
そして、可能であればCASPT2を使ってエネルギー、あるいは分子の構造最適化をしてみましょう。

とは言え、結果を確認できるようにするためには、ある程度用いる手法を統一しておかなければなりません。
`&GATEWAY`は次のような感じにしましょう。

```
&GATEWAY
  Coord = input.xyz
  Basis = 6-31G*
  Group = Full
  NoCD
```

- `Coord`は外部からXYZファイルを読み込むようにしていますが、あらわにXYZファイルを貼り付けても構いません。
- エネルギーが合うかの確認のため、`Basis`はこれにしてください。
- `Group`を使うようにしましょう。reactantとTSは$`C_\mathrm{2v}`$、productは$`D_\mathrm{2h}`$となるようにしましょう。一部の計算では`Group = C1`でないといけないかもしれない（未定）ので、その都度記載します。
- Cholesky分解を使うとHessianが解析的に計算できないので、今回は`NoCD`にします。

また、Hartree–Fockで構造最適化した構造をex01のディレクトリに置いておきます。
条件をそろえても、すべての桁まで一致するとは限らないです。
少なくとも4桁ぐらいは一致するかなと思いますが。

## 01. Hartree–Fock法による計算(1)

まずは、与えられた構造を用いてHartree–Fock法（(R)HF/6-31G(d)）で構造最適化してみましょう。
正しく計算ができていれば、1サイクル目で計算が終了するはずです。
本来TSの計算はそういうものではないですが･･･。
そして、エネルギーは次のような感じになると思います。

||CASSCF energy in a.u.|$`\Delta E`$ in kcal mol<sup>–1</sup>|
|-|-|-|
|reactant|-229.38262545|0.00|
|TS|-229.27063299|+70.28|
|product|-229.27089982|+70.11|

上のエネルギーを大体再現できることを確認し、さらに相対エネルギー（$`\Delta E`$）がどのような式により計算できるかを確認しておきましょう。

## 02. Hartree–Fock法による計算(2)

次に、構造最適化した構造（与えられた構造でも良いです）を用いて、基準振動解析をしてみましょう。
その名の通り、分子の基準振動の固有値（波数）や固有ベクトル（基準振動モード）を計算し、
その結果を用いて零点振動補正やギブズエネルギーへの補正を計算する（熱化学（的）解析？）ことが目的となります。
というわけで、次のような感じで`&MCKINLEY`（と`&MCLR`）というモジュールを使います。

```
&GATEWAY
  Coord = reactant.Opt.xyz
  Basis = 6-31G*
  Group = Full
  NoCD

&SEWARD

&SCF

&MCKINLEY
```

すると、例えばreactantの構造を用いた`&MCKINLEY`の計算結果として

```
    Symmetry a1 
   ==============

                        1         2         3         4         5         6

     Frequency:        i0.13    119.62    494.84    808.85    933.70   1353.77     

     Intensity:    3.611E-09 1.218E-01 8.708E+00 2.843E+01 8.459E+00 7.616E-02
     Red. mass:      7.60311   4.43907   5.36847   1.30502   6.29496   1.09780

     C1         x    0.00001   0.33355  -0.01052  -0.08497  -0.16022  -0.01538
     C1         y    0.31623   0.13133  -0.12530  -0.06423   0.19866   0.01556

```
のような感じになると思います。
これらの結果は、エネルギーの原子核座標に対する二次微分を計算して、原子の質量でスケールしてから対角化をすることにより得ています。
上で示した結果は、reactantの既約表現A<sub>1</sub>で表される基準振動について、

- `Frequency`: 波数（単位はcm<sup>–1</sup>）
- `Intensity`: IR活性の強度
- `Red. mass`: 換算質量
- `C1   x`など: 基準振動モード

を示しています。
1つめのモードは波数がほぼゼロ[^1]になっており、これはポテンシャルエネルギー面が限りなくフラットということに対応しており、
この振動モードに沿って原子を動かしてもエネルギーが（ほぼ）変わらないということを意味します。
今回の計算では、ほぼゼロとなる振動が他の既約表現のものを含めて6つ見えており、これらは並進と回転に対応しています。
各振動モードは`*.freq.molden`を使って可視化することができます。
`Intensity`は、禁制の既約表現の場合は表示されてないです（指標表参照）。

熱化学解析は、次の部分から始まるところです。
```
++ Thermochemistry

 *********************
 *                   *
 *  THERMOCHEMISTRY  *
 *                   *
 *********************
```
まずは次の部分を確認しておきましょう。
```
 Number of trans. and rot. degrees of freedom:  6
 ZPVE                48.444 kcal/mol      0.077201 au.
 ZPVE corrected energy                 -229.305424 au.
```
零点エネルギーの補正が`0.0772101 au.`であると言っています。
零点補正されたエネルギーは、もともとのエネルギー（`-229.38262545`）に`0.077201`を足した`-229.305424 au.`になるようです。
計算の方法は物理化学の教科書参照。
（調和振動子近似を用いた）計算には基準振動の波数が必要なので、零点エネルギーを計算するには基準振動を得る必要があります。

零点エネルギーは内部エネルギーへの補正で、これは温度に依存しない値です。
一方で、エントロピーの寄与は温度に依存します。
ここでは298.15 Kの結果を使うことにしておきましょう。
```
 *****************************************************
 Temperature =   298.15 Kelvin, Pressure =   1.00 atm
 -----------------------------------------------------
 Molecular Partition Function and Molar Entropy:
                        q/V (M**-3)    S(kcal/mol*K)
 Electronic            1.000000E+00        0.000
 Translational         2.028342E+28       38.901
 Rotational            1.478707E+05       26.637
 Vibrational           2.055513E-35        9.734
 TOTAL                 6.165148E-02       75.272

 Thermal contributions to INTERNAL ENERGY:
 Electronic           0.000 kcal/mol      0.000000 au.
 Translational        0.889 kcal/mol      0.001416 au.
 Rotational           0.889 kcal/mol      0.001416 au.
 Vibrational         50.224 kcal/mol      0.080037 au.
 TOTAL               52.001 kcal/mol      0.082870 au.

 Thermal contributions to
 ENTHALPY            52.594 kcal/mol      0.083814 au.
 GIBBS FREE ENERGY   30.152 kcal/mol      0.048050 au.

 Sum of energy and thermal contributions
 INTERNAL ENERGY                       -229.299756 au.
 ENTHALPY                              -229.298812 au.
 GIBBS FREE ENERGY                     -229.334576 au.
 -----------------------------------------------------
```
計算の方法等は物理化学の教科書参照[^2]。
ここでのギブズエネルギーは`-229.334576 au.`となります。
Hartree–Fock法の計算として得られるエネルギーは`-229.38262545` (au)なので、
ギブズエネルギーによる補正（すなわち零点エネルギー、並進・回転、$`PV`$項、エントロピー）により+0.048050 au程度エネルギーが増えるようです。
今回、相対エネルギーを計算する際はこのギブズエネルギーを用いてください[^3]。

なお、ここでのギブズエネルギーというのは理想気体的で剛体モデルを用いて、さらに調和振動子近似を用いています。
ポテンシャルエネルギー面の極値でないと調和振動子近似が使えないので、構造最適化をしたあとで`&MCKINLEY`をする必要があります。
一方で、分子動力学シミュレーションで言う自由エネルギーはアンサンブル平均として得るものなので、
（サンプリングが十分であれば）より正しい自由エネルギーを得られます。
量子化学計算でたくさんのサンプリングを取るのは大変なので、（必要があれば）このような近似的な熱力学的な補正をします。
一般的には反応機構を計算するときぐらいではないかと思います。

productとTSの計算をすると、3つの虚振動が見えるため、この構造は三次の鞍点（あんてん）[^4]に対応します。
このため、得られた構造はポテンシャルエネルギー面上での極小値やTSではないわけです。
これはおそらくHartree–Fockだからで、CASSCFの計算では極小・TSとなるはずです（？）。

||SCF energy in a.u.|Gibbs free energy in a.u.|$`\Delta G`$ in kcal mol<sup>–1</sup>|
|-|-|-|-|
|reactant|-229.38262545|-229.334576|0.00|
|TS|-229.27063299|-229.227300|+67.32|
|product|-229.27089982|-229.226784|+67.64|

どのようにして上の表のGibbs free energyや$`\Delta G`$が得られるかを確認しておきましょう。
$`\Delta E`$的にはTSよりもproductの方が安定ですが、$`\Delta G`$的にはproductの方が不安定となってしまいます。
稀によくあります。

## 03. CASSCFによる計算(1)

CASSCFの計算をするには、まずは活性空間を定義しなければいけません。
このとき、いくつか考慮しなければならない点があります。

- 基本的にはπ共役をしている分子は、できる限り全てのπ軌道を活性空間に入れます
- productにはH原子をもたないC原子があり、これらはn軌道に電子が入る形となります。ラジカルになりうるので、とりあえず活性空間に入れてみましょう。また、この反応ではπ軌道からn軌道のようなcharacterの変化が起こるので、入れておきたい。
- この反応ではσ結合が新しくできるため、この結合に関与する軌道を活性空間に入れなければいけない
- 最終的にproductを$`D_\mathrm{2h}`$の構造にしたいので、結合の生成に関与しないけれど等価な軌道も活性空間に入れないといけない（結合ができる位置が2位と3位であるとすると、5位と6位のあいだのσ結合も含める）

これらを考慮して活性空間を作りましょう。
（必ずしもこれが正解というわけではないですが）12電子・12軌道の活性空間とするのが良いのではと思います。
構成としては、6つのπ軌道・π\*軌道、2つのn軌道、4つのσ・σ\*軌道という雰囲気です。
今回は、状態平均（state-average; `CIROOT`）はとりあえずしなくて良いかな。

ご参考までに、reactantとproductの、活性空間のnatural orbitalを示しておきます（それぞれ<b>Fig. 2</b> と<b>Fig. 3</b> ）。

<center><img src="https://github.com/YoshioNishimoto/sandbox/blob/figure/ex01_02.png" width="512"></center>

<center><b>Fig. 2</b> Reactantのnatural orbital</center>

<br>
<center><img src="https://github.com/YoshioNishimoto/sandbox/blob/figure/ex01_03.png" width="512"></center>

<center><b>Fig. 3</b> Productのnatural orbital</center>

<br>

また、与えられた構造での、CASSCF(12e,12o)の一点計算のエネルギーを示しておきます。

||CASSCF energy in a.u.|$`\Delta E`$ in kcal mol<sup>–1</sup>|
|-|-|-|
|reactant|-229.57067459|0.00|
|TS|-229.51991905|+31.85|
|product|-229.52647146|+27.74|

このCASSCF energyを大体再現しましょう。
収束した後の`*.rasscf.molden`を可視化して、<b>Fig. 2</b>や<b>Fig. 3</b>と比較しておきましょう。
Hartree–Fockの場合はTSの$`\Delta E`$が+70 kcal/mol程度でしたが、CASSCFの場合は31.85 kcal/molとなりました。

## 04. CASSCFによる計算(2)

先ほど行った計算は、電子状態が全対称表現（A<sub>1</sub>またはA<sub>g</sub>）で表される状態です。
これ以外の対称性を持つ波動関数が基底状態となる可能性があります。
他の対称性を持つ電子状態を計算するには、`&RASSCF`のところに`SYMMetry = 2`などのオプションを使います（マニュアル参照）。
基底状態が全対称表現で表される状態であることを確認しましょう。

また、特にproductの場合、基底状態の次に安定な状態は、どのような状態となるでしょうか。

## 05. CASSCFによる計算(3)

他の状態がエネルギー的に近いと交差する場合があり、これを考慮すると選択肢が多くて大変です。
真面目な計算をするのであればともかく、ここでは一重項で全対称表現の状態を使うことにしておきましょう。

まずは、reactantとproductの構造最適化をしてみましょう。
エネルギーはそれぞれ`-229.57428994`と`-229.53800875`ぐらいですかね。
あとでギブズエネルギーを使いたいので、Hartree–Fockと同様に基準振動解析を行っておきましょう。

## 06. CASSCFによる計算(4)

次に、TSの構造最適化をします。
しかし、通常の構造最適化よりも難易度が高くなります。
通常の構造最適化はポテンシャルエネルギー面上での極小値の計算するだけです。
極端なことを言えば、最急降下法のような簡単な方法でも、（構造次第ですが）大抵は上手くいったりします。
しかし、TSは一つの反応座標（基準座標）の波数が負になるため、これはすなわち一つの振動モードに対してのみ極大となる必要があります。
初期構造の時点で基準振動解析をして、波数が負になるモードがないと、基本的にはTSを見つけることができません。
例えば、reactantから普通にTSを求める計算をしても、そもそもプログラムはどのような反応座標をとって反応させれば良いかが分からないため、
TSを求めることに成功することは（普通は）ありません。
このため、まずはTSの候補となる構造を得なければなりません。
そして、その候補となる構造での基準振動が、一つのモードに対して波数が負になっていないといけません（絶対ではないですが）。
というわけで、今回はHartree–Fock法で得た構造があるので、まずはその構造を初期構造として、CASSCF法で基準振動解析をしてみましょう。
やり方はHartree–Fock法の場合と同様です。

（本当はこの結果をあとの計算に使い回せると良いのですが、たぶんSLAPAFでanalytic Hessianを読み込むあたりがバグっている）

得られた`*.freq.molden`の振動を可視化してみると、それっぽい（C–C結合ができるような）振動にはならないと思います。
というわけで、正しいTSの構造に近づけるような工夫が必要となります。

ここでは、C1とC2の距離を1.9 Angstrom[^5]に固定して、それ以外の内部座標を最適化するような計算をしてみます。
Hartree–Fockの構造はC1–C2間距離が1.59 Angstromで、これはどうやら短いようです。
ただ、なぜか（unique atomのconstraintはできないのかも）C1–C2間距離を固定することがうまくできなかったので、点群$`C_1`$で計算をします。
点群$`C_\mathrm{2v}`$で作った活性空間を点群$`C_1`$でそのまま使うことはできないため、
活性空間を作り直す必要があります。頑張りましょう。
モジュール内のオプションは、適宜自分で追加してください。

```
&GATEWAY
  Coord = ts.Opt.xyz
  Basis = 6-31G*
  Group = C1
  NoCD
  Constraints
    a = bond c1 c2
  Values
    a = 1.9 angstrom
  End of Constraints

>> Do while
&SEWARD

&RASSCF
  NACTEL = 12 0 0
  INACTIVE = 14
  RAS2 = 12

&ALASKA

&SLAPAF
>> End Do

&MCKINLEY
```
`Constraints`と`Values`のところで拘束条件を指定します。
左辺の`a =`は特に意味がないので、分かりやすい変数を適当に選んでおきます。
あとは、`bond c1 c2`とすることで、次の表で`Label`のところが`C1`と`C2`になっている原子の距離を拘束条件とします。
```
      Cartesian coordinates in Angstrom:
      -----------------------------------------------------
      No.  Label        X            Y            Z    
      -----------------------------------------------------
       1   C1         0.79620567   1.18302066   0.00000000
       2   C2        -0.79620567   1.18302066   0.00000000
       3   C3         1.34362870   0.00990000   0.00000000
       4   C4        -1.34362870   0.00990000   0.00000000
       5   H5        -1.17731001   2.18271626   0.00000000
       6   H6         1.17731001   2.18271626   0.00000000
       7   C7         0.71537932  -1.19498353   0.00000000
       8   C8        -0.71537932  -1.19498353   0.00000000
       9   H9         1.18845758  -2.15793135   0.00000000
      10   H10       -1.18845758  -2.15793135   0.00000000
      -----------------------------------------------------
      Nuclear repulsion energy =  186.23615787
```
`a = 1.9 Angstrom`は、`Constraints`のところで指定された結合長を、1.9 Angstromに固定することを意味します。
他にもいろいろ固定できるので、マニュアルを参照のこと。

構造最適化の間は、次のような拘束に関わる出力が見られると思います。
```
++ Constraints section
                                  CONSTRAINTS

********************************************************************************
A = BOND C1 C2
VALUES
A = 1.9 ANGSTROM
********************************************************************************


 *************************************************************
 * Values of the primitive constraints                       *
 *************************************************************
 A        : Bond Length=  1.592411 / Angstrom  3.009221 / bohr 


 *******************************************
 * Values of the constraints   / au or rad *
 *******************************************
   Label        C         C0
 Cns001      3.009221  3.590480
```
特に最後のところが、1.9 Angstrom ≒ 3.590480 auが目標となる値で、現在値が3.009221 au ≒ 1.592 Angstromですよ、ということを示しています。
構造最適化のステップを経ると、Cの値が3.590480に近づいていくと思います。
私の場合は13サイクルで構造最適化が終了しました。
```
 Geometry is converged in  13 iterations to a Constrained Minimum Structure
```
実際に分子の構造を可視化し、考えていた部分の結合長が1.9 Angstromになっていることを確認しましょう。
今回は$`C_1`$での構造最適化をしているので、必要に応じて構造を調整し、$`C_\mathrm{2v}`$の構造となるようにしておきましょう。
また、基準振動解析を行い、C–C結合ができるような振動の波数が負になっていることを確認しましょう（正しく計算できていれば）。

## 07. CASSCFによる計算(5)

次に、遷移状態の計算をします。
本来は少し上で計算したHessianを使い回すことが可能なのですが、おそらくOpenMolcasにはバグがあって、`OldF`というオプションが動かないです。
仕方がないので、構造最適化を始める前に`&MCKINLEY`を呼ぶようにしてみましょう。
```
&GATEWAY
  Coord = ts_1.9.Opt.xyz
  Basis = 6-31G*
  Group = Full
  NoCD

>> copy $CurrDir/ts_sp.RasOrb INPORB

>> Do while
&SEWARD

&RASSCF
  LUMORB
  NACTEL = 12 0 0 
  INACTIVE = 7 7 0 0 
  RAS2 = 3 3 3 3 

> if (iter = 1)
&MCKINLEY
> end if

&SLAPAF
  TS  
>> End Do

&MCKINLEY
```
`> if (iter = 1)`というのは、構造最適化の1ステップ目でのみ`&MCKINLEY`を呼んでHessianの計算を行います。
また、`$SLAPAF`の`TS`というオプションを用いると、遷移状態の計算を行うことができます。
基本的には良い初期構造を与えないと構造最適化が成功しないので注意しましょう。

私の計算では、TSのエネルギーは`-229.50902959`となりました。
また、最後にもう一度`&MCKINLEY`をして基準振動解析して、本当にTSであるかを確認しておきます。
私の計算では、最終的な波数が–765.94 cm<sup>–1</sup>ぐらいになりました。
ちなみに、`&LAST_ENERGY`の前に表示される波数は、おそらく近似的なHessianを用いています。
使えないわけではないですが、用途は限られています。
一般的には、TSが見つかったあとでHessianを計算し直します。

これでHartree–Fock法の場合と同様にして、CASSCFによるエネルギーおよびギブズエネルギーを得ることができます。

||CASSCF energy in a.u.|$`\Delta E`$ in kcal mol<sup>–1</sup>|CASSCF Gibbs free energy in a.u.|$`\Delta G`$ in kcal mol<sup>–1</sup>|
|-|-|-|-|-|
|reactant|-229.57428994|0.00||0.00|
|TS|-229.50902959|+40.95|-229.463788||
|product|-229.53800875|+22.77|||

あいている部分を埋めましょう。

## 08. CASSCFによる計算(6)

遷移状態の構造が得られたら、その遷移状態はどのようなreactantとproductの間をつなぐ遷移状態なのかを確認しなければいけません。
遷移状態から虚振動の向きに沿って分子を動かしていく手法を、極限反応座標（intrinsic reaction coordinate; IRC)と呼んだりしています。
OpenMolcasでは次のような感じで計算します。

```
&GATEWAY
  Coord = $CurrDir/ts.Opt.xyz
  Basis = 6-31G*
  Group = FULL
  NoCD

> COPY $CurrDir/ts.RasOrb INPORB
> export MOLCAS_MAXITER=500

> do while

&SEWARD

&RASSCF
  LUMORB
  NACTEL = 12 0 0 
  INACTIVE = 7 7 0 0 
  RAS2 = 3 3 3 3 

&SLAPAF
  IRC 
  Reaction vector
  6.614430828401E-01  5.028928013301E-04 0.0d+00
 -3.475485016277E-02  2.714271132467E-02 0.0d+00
  9.099707379976E-02  2.204929526768E-01 0.0d+00
 -3.565000609968E-02 -4.455187320886E-02 0.0d+00
  5.287519865910E-03 -1.915225955363E-02 0.0d+00
  Iterations = 200 
  nirc = 100 

> end do
```
いくつかのEMILコマンドは置いておいて･･･。
`&SLAPAF`で`IRC`というオプションを用いると、IRCの計算をすることができます。
ここで、`Reaction vector`というオプションが必要です。
これが、虚振動の振動モードを示しています。
遷移状態の構造最適化をした際に
```
 *********************************************************
 * The Cartesian Reaction vector                         *
 *********************************************************
  ATOM              X               Y               Z     
  C1               0.031465       -0.012086        0.000000
  C2              -0.014608        0.016228        0.000000
  H3               0.073923        0.017933        0.000000
  C4              -0.005157       -0.005326        0.000000
  H5              -0.004357       -0.003842        0.000000
```
というのが出ているかもしれませんが、これは近似的な反応座標ベクトルなので、改めてHessianを計算して得た反応座標ベクトルを使いましょう。
これは、`$Project.UnSym`または`$Project.freq.molden`に書いてあるベクトルを使うのが良いでしょう。
今回の場合、前者のファイルにはたぶん9行目から、後者のファイルでは81行目から示されるのではないかと思います。
ただし、前者の場合はZ軸方向の振動ベクトル（すべてゼロ）を追加する必要があります。
後者の場合は、対称操作を行うと重なってしまう原子のベクトルは取り除く必要があります。
面倒ですが頑張りましょう。
`Iterations`と`nirc`は、たぶん後者だけでいい気もします。

TSまわりには行き(forward)と帰り(backward)の反応パスがあるので、両方の計算が行われます。
ただし、行きと帰りはReaction vectorの符号の向きに対応するだけなので、必ずしも環化反応がforwardに対応するとは限りません。
対応させたい場合は、Reaction vectorの符号の向きを変えましょう。

forwardの結果は次のような感じでした。
```
++ IRC/Minimum Energy Path Information

 Last IRC/MEP step (in weighted coordinates / sqrt(total weight))
 --------------------------------------------------------
        Residual gradient size:     0.000295 hartree/bohr
 Angle with constraint surface:    14.472537 degrees
                    Path angle:    10.170861 degrees
                Path curvature:     4.414475 bohr^(-1)
                   Path length:     0.040212 bohr

 IRC(forward)-search terminated due to small gradient!


          Cumul.
 Point  Length (bohr)       Energy  Curvature
 --------------------------------------------
     0   0.000000    -229.50902958   0.000000
     1   0.020088    -229.50935741  -0.000000
（省略）
    36   1.421912    -229.57418788   4.414475
--
```
勾配ベクトルがしきい値よりも小さくなった時点でIRCの計算を終了します。
近くに極小点がある（と考えられる）ためです。
実際、最終的な値（`-229.57418788`）はreactantのエネルギー（`-229.57428994`）に非常に近くなっており、
IRCの結果としてreactantの近くが見つけられました。

backwardの結果は次のような感じでした。
```
++ IRC/Minimum Energy Path Information

 IRC(backward)-search terminated due to problematic constraint!


          Cumul.
 Point  Length (bohr)       Energy  Curvature
 --------------------------------------------
     0   0.000000    -229.50902958   0.000000
（省略）
     7  -0.259674    -229.53797576   9.311790
--
```
problematic constraintとか言われていますが、最終的なエネルギーはproductのエネルギー（`-229.53800875`）にかなり近いので、正しい反応パスが得られていると言って良いでしょう。

IRCの結果、forwardとbackwardでそれぞれreactantとproductの構造が得られました。
これは、得られたTSは確かにreactantとproductをつなぐものである、と言えるようになります。
ここまでできて、ようやくBergman環化反応の反応経路が分かったこととなります。お疲れ様でした。
IRC中の構造は`$Project.irc.molden`に示されるので、思ったような環化反応になっていることを確認しましょう。

反応座標に沿ってエネルギーをプロットして、どのようなポテンシャルエネルギーカーブになるかをチェックしましょう。

## 09. CASPT2による計算(1)

WIP。CASPT2のページを作ってからか？

---

[^1]: 計算上厳密にゼロになることはまずないです。目安というものは特にないですが、このぐらいの計算であれば、波数の絶対値が10 cm<sup>–1</sup>未満になって欲しいなと思います。
[^2]: 物理化学演習Bでこれらを計算する方法を第14回目にやっていましたが、最近やっていたかの記憶がない。
[^3]: 今時の物理化学の教科書では「ヘルムホルツエネルギー」あるいは「ギブズエネルギー」と言いますが、論文やプログラムでは「ヘルムホルツ自由エネルギー」あるいは「ギブズ自由エネルギー」と呼ぶことが多いです。単に「自由エネルギー」と呼ぶ場合も。
[^4]: 三次の遷移状態とは言わない。遷移状態は一次の鞍点にしか用いない。
[^5]: なぜ1.9 Angstromという値かというと、少しずつC–C間距離を変化させるという予備的な計算を行ったから。
