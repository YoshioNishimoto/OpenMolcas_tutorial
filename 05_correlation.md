# 単参照電子相関理論

大仰なタイトルですが･･･。
ここではまとめて三つの単参照電子相関理論（single-reference electron correlation theory）を扱います。

* 摂動理論（PT; perturbation theory, 特に[MP2](https://ja.wikipedia.org/wiki/%E3%83%A1%E3%83%A9%E3%83%BC%EF%BC%9D%E3%83%97%E3%83%AC%E3%82%BB%E3%83%83%E3%83%88%E6%B3%95)）
* [結合クラスター法](https://ja.wikipedia.org/wiki/%E7%B5%90%E5%90%88%E3%82%AF%E3%83%A9%E3%82%B9%E3%82%BF%E3%83%BC%E6%B3%95)（CC; coupled cluster）
* [配置間相互作用法](https://ja.wikipedia.org/wiki/%E9%85%8D%E7%BD%AE%E9%96%93%E7%9B%B8%E4%BA%92%E4%BD%9C%E7%94%A8%E6%B3%95)（CI; configuration interaction）

ここでは計算の方法や特徴を示すだけです。
それぞれの理論の詳細はSzabo先生の教科書のそれぞれChapter 6,5,4やHelgaker先生の鈍器（Molecular Electronic-Structure Theory）などに譲るとします。

「単参照」は「一つのスレーター行列式で記述した」ということを示しています[^1]。
一つのスレーター行列式というのは、ここではHartree–Fock法の事に対応します（Szabo: Chapter 3あたりが詳しいと思います）。
Hartree–Fock法の計算結果（すなわち分子軌道係数）を元にして、電子相関理論の計算（電子を励起させた電子配置を考える）を行います。
このため、総称としてpost Hartree–Fock法と呼ばれたりもします。

「電子相関」は、電子が多数存在することにより生じる量子的な効果です。
Hartree–Fock法では電子間の相互作用を平均場近似により考える理論です。
一方で、正確な波動関数は電子の相互作用を多体的に取り扱うべきですが、それが難しいため平均場近似を用いています。
その多体的な効果を取り入れるために電子相関を計算し、より精度の高いエネルギー・物性値などを得ることができるようになります。
Hartree–Fock法でも分子・電子の99%を記述できると言われていますが、
残りの1%が化学精度（1 kcal/mol?）を達成するのに必要です。
例えば分散項がその例で、非経験的に取り入れるためには電子相関の考慮が必要になります。

Per-Olov Löwdinの定義によると、電子相関エネルギーは正確な（すなわちfull CI）エネルギーとHartree–Fock法のエネルギーとの差であると考えられています[^2]。
full CIは電子相関エネルギーを完全に取り入れることができるため、
full CIの計算が常にできれば計算化学の研究の大部分はそこで終わりです。
それができないため様々な電子相関理論が提案されてきました。

電子相関は、形式的に「動的電子相関（dynamical electron correlation）」と「静的電子相関（static or non-dynamic electron correlation）」に分けて考えます。
ここで取り扱う単参照電子相関理論は、前者の動的電子相関をある程度正しく取り入れることができますが、
後者の静的電子相関はほとんど考慮することができません。
静的電子相関を取り扱うためには、多配置（multi-configuration(al)）のself-consistent field法（MCSCF）や、
さらに高度な多参照電子相関理論（multi-reference electron correlation theory）を用います。
原理的には、full CIに次いで多参照電子相関理論が最も精度が高くなるでしょう（実用的かは別の話）。
最初に「形式的に」と書いたのは、実際には電子相関を分けることができないためです。
例えば単参照のCIやCCでも、励起電子数を上げていくとfull CIに到達します。
full CIは電子相関を完全に取り入れることができる[^3]ので、当然動的・静的電子相関の両方を完全に取り入れることができます。
動的電子相関を取り入れられる手法の極限では、静的電子相関も入ってくるわけです。

現状このチュートリアルで取り扱うか分かりません[^4]が、密度汎関数理論（DFT; density functional theory）は、全く別の方法で電子相関を取り扱います。
計算の際に「交換相関汎関数」を指定した（例えばB3LYP）と思いますが、アレにより電子相関を取り扱っています。
前述の電子相関理論（波動関数理論）は励起電子数を上げることで系統的にfull CIの解に近づくことができますが、
DFTではそのような系統的なアプローチは発見されていません。
だからといってDFTの精度が良くないというわけではありません。
多くの場合、低い計算コストでかなり実験値に近い計算結果を返してくれます。

***

PySCFを用いた単参照電子相関理論の計算自体は、特に難しいことはありません。
少しのキーワード・行を追加するだけで計算を行ってくれます。
ここでは以下の計算レベルで計算を行ってみます。

* PT: MP2
* CC: CCSD, CCSD(T)
* CI: CISD, full CI

計算のインプットを書くのは簡単ですが、理論・プログラムは難しいです。
とりあえず使ってみてください、という感じです。
また、インプットの書き方も一通りではないので、自分のやりやすい方法を見つけてください。

計算手続きに関してもう少し説明すると、電子相関の計算は一般的に二つのステップを踏みます。
まずはHartree–Fock計算を行い一電子波動関数（用いる電子配置は既に決まっているので、分子軌道と言っても良い）を得ます。
そして、その波動関数を用いて電子相関の計算（励起した電子配置を考える）を行います。
Hartree–Fock法による波動関数は上の定義では電子相関がゼロと考えるため、この波動関数を用いて電子相関計算を行うことで、電子相関を二重に計算してしまう可能性をなくします。
このため、普通は最初のHartree–Fock計算はDFT計算であってはいけません。
電子相関の一部を二重に計算してしまう可能性があるためです。

## 摂動理論の計算

一言で摂動理論と言っても、ゼロ次ハミルトニアンの定義が任意であるためいろいろですが、
多くの場合MP2 (second-order Møller–Plesset perturbation theory)のことを指しています。
ここでもMP2の計算を行ってみます。
MP2は二電子励起を摂動的に取り扱います（CIやCCは変分的）。
より多くの励起電子配置を取り扱う場合は、MP3, MP4, ･･･と続きます。
OpenMolcasではMP2のみ実装されています。

MP2の特徴は、比較的低い計算コストで、それなりの精度を出すことでしょう。
ただ、摂動展開が必ずしも収束するとは限りませんし、精度もせいぜい「それなり」です。
結合エネルギーや分散力を過大評価しがちです。
SCS-MP2 (spin component scaled)というのもありますが、OpenMolcasではできそうにないです。
SOS-MP2 (scaled opposite-spin)はできます（ただし`&GATEWAY`に`RICD`が必要）。
これはoppsite spinの寄与だけを1.3倍（経験的パラメータ）するというものです。
もともとはSCS-MP2に物理的にもっともらしそうな理由をつけて、opposite-spinとsame-spinの項をスケーリングしていましたが、
おそらく計算の都合でopposite-spinだけをスケールしているのだと思います。

MP2の計算には`&MBPT2`（many-body second-order perturbation theory）というモジュールを用います。
```
&GATEWAY
  Coord
  6
  ethylene
  C1              -0.658467        0.000000        0.000000
  C2               0.658467        0.000000        0.000000
  H3              -1.225694        0.914334        0.000000
  H4              -1.225694       -0.914334        0.000000
  H5               1.225694        0.914334        0.000000
  H6               1.225694       -0.914334        0.000000
  Basis = 6-31G*
  Group = C1
  RICD

&SEWARD

&SCF

&MBPT2

&MBPT2
  SOSMP2
```
マニュアルには書いていませんが、`SOSMP2`なるキーワードを使うことで、SOS-MP2の計算をすることができます。
もっとも、何も書かなくてもopposite-spinの寄与を表示してくれるので、後からSOS-MP2のエネルギーを計算することは可能のはずです。
･･･が、自分の計算とは合わないのでよく分からないです。
もしかすると、`Opposite-Spin contribution`で計算しているものは、SOS-MP2の計算に使うエネルギーとは異なるのかも。

で、出力として以下が得られます。
```
      ********************************************************************************************************
      *                                               Results                                                *
      ********************************************************************************************************


       SCF energy                           =      -78.0315443528 a.u.
       Second-order correlation energy      =       -0.2525001973 a.u.
       ( Opposite-Spin contribution         =       -0.1953449306 )

       Total energy                         =      -78.2840445501 a.u.

       Reference weight ( Cref**2 )         =        0.91736

::    Total MBPT2 energy                              -78.2840445501


       Zeroth-order energy (E0)             =      -19.0549827149 a.u.

       Shanks-type energy S1(E)             =      -78.2851302439 a.u.

```
`SCF energy`がHartree–Fockのエネルギーに対応しています。
そして、`Second-order correlation energy`が二次の摂動計算により得られた補正の値です。
そして、いわゆる「MP2レベルのエネルギー」というのは`Total energy`または`Total MBPT2 energy`に示されている、`-78.2840445501 a.u.`となります。
普通のMP2は繰り返し計算を行わずに計算ができる（ゼロ次ハミルトニアンが簡単なので、$`\langle \Psi^{(1)}|\hat{H}_0-E_0|\Psi^{(1)}\rangle`$から出てくる各励起電子配置の要素に対して対角行列となる）ため、計算コストは割と低めです。
それでも一般的には$`\mathcal{O}(N^5)`$の計算が必要とされており、HFやDFTよりは時間がかかります。

## 結合クラスター法の計算

私自身は結合クラスターと表現しないので、正しいのか分かりません。
coupled clusterと言っています。
OpenMolcasではCCSDとCCSD(T)の計算を行うことができます。
ここでは人間により実装された物のみを用います。
CCSDのうち、CCはcoupled clusterのことで、
SとDはそれぞれsingleとdoubleのことで、一電子励起と二電子励起を（変分的に取り扱うこと）を意味します。
CCSD(T)の(T)が括弧書きされているのは、変分的に決定した一・二電子の励起強度を用いて、三電子励起を摂動的に取り扱うことを意味しています。

CCの特徴は、やはりその精度でしょう。
特にCCSD(T)は計算化学のgold standard（金字塔？）とも呼ばれており、「これをやっておけば間違いない」という手法です（間違う場合もあります）。
ですが、その分計算コストも高いです。
CCSD(T)の場合は、分子軌道の数が二倍大きくなると計算コストが128 (=2<sup>7</sup>)倍増えるとされています。

CCと後述予定のCIはどちらも見た目（文字のこと）は似たような手法で、どちらも一・二電子励起を取り扱っています。
しかし、CCSDの場合は二電子励起の積の形で四電子励起までを取り扱う（disconnected quadruple excitation）というところが違います。
演算子の観点から言うと、CIの場合は励起演算子を直接Hartree–Fockの波動関数に作用させるのに対して、CCの場合はべき乗励起演算子を作用させます。
さらにクラスター展開を行うことで、二電子励起の演算子までしか入っていなくても、積の形で四電子励起を表す項が出てきます。
この項は直接四電子励起（connected quadruple excitation）を扱うよりも寄与が大きいらしいため、わざわざ四電子励起を扱わなくても精度の改善が期待できます。
さらに、disconnectedな項を取り入れることで、truncated CIで問題となるsize-extensivityの問題も解決されます。

というわけで、CCSDとCCSD(T)の計算をしてみます。
おそらくミニマムなインプットファイルは次のような感じになると思います。

```
&GATEWAY
  Coord
  6
  ethylene
  C1              -0.658467        0.000000        0.000000
  C2               0.658467        0.000000        0.000000
  H3              -1.225694        0.914334        0.000000
  H4              -1.225694       -0.914334        0.000000
  H5               1.225694        0.914334        0.000000
  H6               1.225694       -0.914334        0.000000
  Basis = 6-31G*
  Group = C1
  RICD

&SEWARD

&RASSCF
  OutOrbitals = Canonical

&MOTRA

&CCSDT
```
なぜか`&SCF`だとうまく計算できないので、`&RASSCF`という新しいモジュールを使っています。
本来はCASSCF/RASSCFの計算をするときに使うもののはずですが･･･。
また、`&MOTRA`というのはカノニカル分子軌道を基底とした電子反発積分（二電子積分）の計算をするモジュールです。
プログラムによっては自分でこれらの積分を計算するように宣言する必要があります。
そして、`&CCSDT`というモジュールで、CCSDとCCSD(T)のエネルギーを計算するという流れです。

結果としては、以下のような部分が得られると思います（755行目付近）。
```
      Iteration       Total enegy      Corr. energy      Difference
          1          -78.28404456      -0.25250020      -0.25250020
          2          -78.30033667      -0.26879232      -0.01629212
          3          -78.30806981      -0.27652546      -0.00773314
          4          -78.30997868      -0.27843432      -0.00190886
          5          -78.31086416      -0.27931981      -0.00088549
          6          -78.31123410      -0.27968975      -0.00036994
          7          -78.31141512      -0.27987076      -0.00018101
          8          -78.31150483      -0.27996047      -0.00008971
          9          -78.31155126      -0.28000691      -0.00004643
         10          -78.31157568      -0.28003133      -0.00002442
         11          -78.31158873      -0.28004438      -0.00001305
         12          -78.31159578      -0.28005142      -0.00000704
         13          -78.31159960      -0.28005525      -0.00000383
         14          -78.31160169      -0.28005734      -0.00000209
         15          -78.31160284      -0.28005848      -0.00000114
         16          -78.31160346      -0.28005911      -0.00000063
         17          -78.31160381      -0.28005946      -0.00000035
         18          -78.31160400      -0.28005965      -0.00000019
         19          -78.31160411      -0.28005975      -0.00000011
         20          -78.31160416      -0.28005981      -0.00000006
      Convergence after                    21  Iterations


      Total energy (diff) :     -78.31160416      -0.00000006
      Correlation energy  :        -0.2800598116773
      Reference energy    :       -78.0315443527805
      E1aa   contribution :       0.00000000
      E1bb   contribution :       0.00000000
      E2aaaa contribution :      -0.02615276
      E2bbbb contribution :      -0.02615276
      E2abab contribution :      -0.22775429
```
ここはCCSDのエネルギー（`Total energy`で表示される、`-78.31160416`の部分）を決定しています。
MP2の場合とは異なり、励起強度は繰り返し計算により決定します。

CCSD(T)のエネルギーはさらに、下で見つけられます（864行目付近）。
```
  Work space requirements :               239256
  Allocation of work space : Done
       CCSD     =       -78.3116041644578
       T3 corr. =        -0.0090059989174
       CCSD + T3=       -78.3206101633752
  T3 energy decomposition into spin parts
  Eaaa =  -1.4820322459774575E-004
  Eaab =  -4.3547962341069398E-003
  Eabb =  -4.3547962341069432E-003
  Ebbb =  -1.4820322459774577E-004
```
`T3 corr.`というのは摂動による三電子励起の補正で、最終的なCCSD(T)のエネルギーは`CCSD + T3=       -78.3206101633752`で表示されるエネルギーとなります。
どのエネルギーも、原子単位で表示されています。

`&GATEWAY`で`RICD`を指定する場合は、計算効率の良い（らしい）`&CHCC`と`&CHT3`というモジュールを利用することができます。
こちらは`&SCF`の結果を使って動かせるようです。
```
&GATEWAY
  Coord
  6
  ethylene
  C1              -0.658467        0.000000        0.000000
  C2               0.658467        0.000000        0.000000
  H3              -1.225694        0.914334        0.000000
  H4              -1.225694       -0.914334        0.000000
  H5               1.225694        0.914334        0.000000
  H6               1.225694       -0.914334        0.000000
  Basis = 6-31G*
  Group = C1
  RICD

&SEWARD

&SCF

&CHCC

&CHT3
```
さて、このまま計算をしてエネルギーを比較すると、上の計算と結果が合わないと思います。
プログラムにバグはありません（たぶん）。
アウトプットファイルをよく比較し、何が正しくないかを見つけ、上の計算と結果が合うようにしましょう。

## 配置間相互作用法の計算

ここではCISDとfull CIの計算を行ってみます。
CISDの"S"と"D"は、それぞれsingle excitationとdouble excitationを意味しています。
一電子励起・二電子励起と、励起する電子の数を示しているわけです。
なので、三電子励起まで含める場合にはCISDTになるでしょう（PySCFではたぶん行えない計算です）。
full CIは、考え得る全ての電子配置を考えます。
ですが問題は、電子数・分子軌道の数が大きくなるにつれて急速に計算コストが上昇していくことです。
full CIが取り扱えるのは、現実的（手元のパソコンでできるような計算）には1~3原子で中ぐらいの基底関数程度でしょう。

truncated CI（full CI以外のCI。truncatedは励起電子配置の打ち切りを意味しています）の良くない特徴としては、[size-extensivityとstrict separability（とsize-consistency）](https://ja.wikipedia.org/wiki/%E5%A4%A7%E3%81%8D%E3%81%95%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6%E3%81%AE%E7%84%A1%E7%9F%9B%E7%9B%BE%E6%80%A7)が満たされない点です（詳しくはSzabo: Chapter 4）。
このため（か分かりませんが）、単参照の計算ではCCやPTの方が見る機会が多いと思います（個人の感想です）。
full CI, CCSD, CCSD(T), MP2は、どちらの性質も満たす手法です。

とりあえずCISDの計算をしてみることにします。
入力ファイルの作成はいろいろ方法がありますが、まずはCCSDと同じように`&RASSCF&のモジュールを使う方法です。
```
&GATEWAY
  Coord
  6
  ethylene
  C1              -0.658467        0.000000        0.000000
  C2               0.658467        0.000000        0.000000
  H3              -1.225694        0.914334        0.000000
  H4              -1.225694       -0.914334        0.000000
  H5               1.225694        0.914334        0.000000
  H6               1.225694       -0.914334        0.000000
  Basis = 6-31G*
  Group = C1
  RICD

&SEWARD

&SCF

&RASSCF
  FROZEN = 2 
  RAS1 = 6 
  RAS2 = 0 
  RAS3 = 30
  NACTEL = 12 2 2 
  CIONLY
```
`FROZEN`はRASSCFのあいだ凍結させておく分子軌道の数を指します。
このオプションはなくても良いのですが、1s軌道の数を入れておくことにします。
`RAS1`と`RAS3`は、ここでは（電子相関計算に使う）それぞれ占有軌道と非占有軌道の数となります。
本来8個の占有軌道がありますが、2つの軌道を凍結させるので、ここでは`RAS1`が6となります。
`NACTEL`は電子数を指定します。
一つ目は電子相関計算に使う電子数、二つ目は占有軌道から励起させる最大の電子数、三つ目は非占有軌道へ励起する最大の電子数を指定します。
二つ目と三つ目の値を変更すると、三電子励起まで考慮するCI計算（CISDT）を行ったりすることも可能です。

アウトプットで一つ着目すべきは以下の行でしょう。
```
++    CI expansion specifications:
      ----------------------------

      Number of CSFs                         16471
      Number of determinants                 22996
```
Hartree–Fockの計算は一つの行列式を使って計算を行っていましたが、
ここでは一次の波動関数を22996個の行列式の線形結合で表現します。
CSFはconfiguration state functionのことです。
行列式は必ずしも&`\hat{S}^2`&の固有関数ではありませんが、線形結合をとって（ここでは一重項の）固有関数にしたものがCSFです。
励起する電子数が多いと、これらの数が飛躍的に大きくなり、計算時間も飛躍的に多くなるので注意しましょう。
例えばCISDTの場合、行列式の数は1,278,696となります。

また、結果として以下のようなエネルギーや電子配置と線形結合の係数が得られます。
```
      ************************************************************************************************************************
                                                      Wave function printout:
                       occupation of active orbitals, and spin coupling of open shells (u,d: Spin up or down)
      ************************************************************************************************************************

      Note: transformation to natural orbitals
      has been made, which may change the order of the CSFs.

      printout of CI-coefficients larger than  0.05 for root  1
      energy=     -78.290795
      conf/sym  111111111111111111111111111111111111     Coeff  Weight
             1  222222000000000000000000000000000000   0.95324 0.90866
             8  222220200000000000000000000000000000  -0.10954 0.01200

      Natural orbitals and occupation numbers for root  1
      sym 1:   1.982873   1.977191   1.975306   1.969972   1.972967   1.941675   0.047025   0.015895   0.017714   0.016859
               0.014082   0.014242   0.005583   0.007197   0.006736   0.006767   0.001846   0.004269   0.000567   0.000326
               0.000466   0.000417   0.000211   0.002706   0.003172   0.003508   0.002109   0.001605   0.001539   0.000931
               0.000943   0.000700   0.000819   0.001677   0.000067   0.000040
```
`0.95324`の係数となるものが閉殻一重項に近い事が分かります。
今回は基底状態の計算なので、閉殻一重項の配置の寄与が最も多きいのはなんとなく分かると思います。
さらに、HOMOからLUMOへ二電子励起した電子配置が約1.2%（？）入っています。
CISDの波動関数は、主にこれら二つの電子配置の線形結合で表されるわけです。
ただし、係数が小さいものは省略されているだけで、他にもたくさんの電子配置が入ってきています。
エネルギーは`-78.290795`です。

`Natural orbitals and occupation numbers`は自然軌道の占有数です。
自然軌道は確か一電子の密度行列を対角化して得られる固有ベクトルで、その固有値が占有数となります。
つまりは、軌道の占有数です。[^5]
波動関数には励起した電子配置が含まれるようになっているため、そのおかげで占有数はもはや2や0という整数では表されません。

もう一つの方法は`&MRCI`というモジュールを用います。
```
&GATEWAY
  Coord
  6
  ethylene
  C1              -0.658467        0.000000        0.000000
  C2               0.658467        0.000000        0.000000
  H3              -1.225694        0.914334        0.000000
  H4              -1.225694       -0.914334        0.000000
  H5               1.225694        0.914334        0.000000
  H6               1.225694       -0.914334        0.000000
  Basis = 6-31G*
  Group = C1
  RICD

&SEWARD

&SCF

&MOTRA

&GUGA
  SPIN = 1
  INACTIVE = 6
  CIALL = 1

&MRCI
  SDCI
```
`&MOTRA`は既出です。
`&GUGA`（graphical unitary group approach）は結合係数と呼ばれる$`\langle I | \hat{E}_{pq} | J \rangle`$などを作るプログラムです。
そして、`&MRCI`でCISDの計算をします。
本来は多参照のCISD計算をするプログラムですが、単参照の場合も使えます。
エネルギーは（正しいインプットファイルが作れていれば）上の計算と同じになります。

***

ここで紹介した手法は、二原子分子とかなら良いのですが、少し原子（基底関数）のサイズが大きくなると、
急激に計算時間が増大していきます。
一方でDFTは汎関数にもよりますが、それほど急激に計算コストが増大しません。

波動関数理論の計算で一つ時間がかかるのは二電子積分のAO->MO変換で、これは5乗のスケーリング（系のサイズが2倍になると、計算時間は32 (=2<sup>5</sup>倍）になる）です。
これは、OpenMolcasの場合はCholesky分解（`RICD`のオプション）により計算時間を減らしています。
また、多くのプログラムは空間対称性を用いることにより、さらに計算時間を減らせるはずです。

前段落のAO->MO変換は単なる計算の準備であり、加えて電子相関エネルギーを計算しなくてはいけません。
もちろん電子相関エネルギーの計算にも時間がかかります。
具体的な式（式を見ればスケーリングを推測できます）は各種文献等を参照して欲しいところですが、
例えばMP2は4乗のスケーリング、CCSDは6乗のスケーリング、CCSD(T)は7乗のスケーリング、CISDは6乗のスケーリングと、
それぞれの手法で大体どのようなペースで計算コストが増大するかが決まっています。
しかも、CIとCCは一般的なアルゴリズムでは繰り返し計算を行う必要があるため、さらに収束までに必要な繰り返し計算の回数分だけ計算コストがかかります。

このスケーリングの問題のみならず、
波動関数理論では基底関数の収束性が悪い（大きな基底関数を使わないといけない）というのも難しい問題で、
このためさらに計算時間が長くなりやすく、取り扱える系のサイズが制限されがちです。
それでも、DFTとは異なり手法の精度を系統的に改善できるという性質は重要で、今なお（日本ではともかく）理論開発は活発です。

おそらくここで紹介したいくつかの手法で一次の性質（特に勾配）の計算が可能です。
構造最適化もやってみてみてください。

## 演習問題

- 適切に計算条件を設定し、これまでに用いた手法の計算時間を計測して比較してみましょう。
- 構造最適化ができる（数値微分ではなく、解析的な微分が計算可能な）手法・モジュールを教えてください。
- 非占有分子軌道の軌道エネルギーは占有分子軌道の軌道エネルギーよりも高いため、励起した電子配置を取り入れるとエネルギーが高くなる気がします。もちろんそうなる場合もあります（励起状態計算）が、ここで扱った手法の相関エネルギーは負になっているので、エネルギーは低くなっています。励起した電子配置を取り入れるとエネルギーが低くなる理由を教えてください。
- Size-extensivity（strict separability）について検証してみましょう。どんな分子でも良いのですが、例えばCH<sub>4</sub>を100 Angstromぐらい離して計算したときの相互作用エネルギーを計算してみましょう。正しい理論なら、ほとんどゼロになるはずですが、特にCISDの場合はどうでしょうか。
- 適当な基底関数（あまりに大きいと計算時間がかかる。特にfull CIはメモリ・計算時間に注意。N<sub>2</sub>が厳しければfull CIはしなくて良いです）とこれまでに紹介した手法（CISDは使わなくて良い）を組み合わせて、He<sub>2</sub>やN<sub>2</sub>のポテンシャルエネルギーカーブを描いてみましょう[^6]。特に、N<sub>2</sub>の場合にCCSD(T)は正しそうでしょうか。
- CISDとCCSDは一電子励起に対応する文字が入っており一電子励起の効果が取り込まれているのに、MP2で一電子励起を取り扱わないのはなぜでしょう。また、MP0エネルギーとMP1エネルギーが存在するとして、それらはどのようなエネルギーに対応するでしょうか。ちなみに、MP2法ではゼロ次ハミルトニアンとしてフォック演算子を用いています。
- 時間があれば(SCS-)MP2を実装してみましょう。

[^1]: これ自体は単配置の説明です。単配置と単参照で具体的にどのように区別して定義されているのか実は理解していませんが、単参照をもう少し真面目に書くと「単配置波動関数を基にして（参照して）電子相関計算を行った」場合に単参照電子相関計算を行ったと言うと考えています（正しいかは不明）。
[^2]: Hartree--Fock法の電子相関がゼロと表現する人がいますが、たぶん正しくありません。
交換項が電子相関の一部と考えることができるからです。
定義を明確にした上で、ゼロと表現するなら良いと思います。
[^3]: full CI自体は正しい理論ですが、それは時間非依存・非相対論での理論です。
また、我々の計算では基底関数のサイズが無限に大きくすることができません。
このため（他の理由もあるでしょうが）、full CIで得られた結果が必ず正しいというわけではありません。
与えられた基底関数で、時間非依存・非相対論の枠組みの中では正しい解を与えます。
[^4]: OpenMolcasでDFT計算をするメリットが思いつかない。別のプログラムを使うべき。
[^5]: 単配置の波動関数であれば、占有数は整数となり「二電子占有されている」などと簡単にいうことができますが、そうでない場合はいわゆる普通の分子軌道（canonical molecular orbitals）が使って密度行列を対角化できるとは限らないので、普通の分子軌道ではなく自然軌道なるものを計算してやる必要があります。演算子が可換でないのだと思います。
[^6]: 議論に用いることができるグラフにすること。見た目で重なっているグラフでは議論ができない。
