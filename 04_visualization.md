# 分子軌道の可視化

分子軌道の可視化を行います。
[一点計算](01_sp1.md)のところでご紹介したとおり、分子軌道（ $`\psi_i`$）は基底関数（原子軌道）（$`\chi_\mu`$）の線形結合により表されます。
```math
\displaystyle\psi_i=\sum_\mu{\chi}_{\mu}C_{{\mu}i}
```
(Szabo: 式(3.133))。$`\displaystyle{C}_{{\mu}i}`$は分子軌道係数です。詳しくはSzabo: Sec.3.4.2や3.5.1をご参照ください。
今回可視化するのは分子軌道（  $`\psi_i`$）のことです。
原子軌道と混同しないでください。
また、ここでは直交した分子軌道（canonical molecular orbitalとも呼ばれる）を可視化します。
他にも自然軌道や局在化軌道を可視化することも可能です。
なお、次回以降でMCSCF (CASSCF/RASSCF)の計算をしていく予定です。
MCSCFの計算はこれまでのHartree–Fock計算とは違い、インプットファイルを作る際に活性空間を指定する必要が出てきます。
活性空間を指定するときは基本的に目で見て活性空間に含める・含めないを判断しますので、分子軌道を可視化することが必須となります。

とりあえず、ここではethylene (C<sub>2</sub>H<sub>4</sub>)のπ軌道とπ\*軌道、すなわち最高占有軌道(HOMO; highest occupied molecular orbital)と最低非占有軌道(LUMO; lowest unoccupied molecular orbital)の分子軌道（下図参照）を描いてみます。
なお、ここで描きたい軌道が必ずしもHOMOとLUMOに対応するかは自明ではありません。
基底関数によっては偶然にもHOMOとLUMOがそれぞれπ軌道とπ\*軌道に対応しますが、場合によってはかなり低い（高い）準位まで探す必要があります。
可視化ソフトウェア（[VMD](https://www.ks.uiuc.edu/Research/vmd/)や[Avogadro](https://avogadro.cc/)など）はインストール済みとします。
私は[Chemcraft](https://www.chemcraftprog.com/)を用いています。

HOMO: <img src="https://github.com/YoshioNishimoto/sandbox/blob/figure/ethylene_HOMO.png" width="128">

LUMO: <img src="https://github.com/YoshioNishimoto/sandbox/blob/figure/ethylene_LUMO.png" width="128">

まずはエチレン（まずは$`C_1`$）を(R)HF/6-31G(d)レベル（(R)HF/STO-3Gの方が良いかも。一般的は、小さい基底関数を用いた方が分子軌道を解釈しやすくなります）で構造最適化してみてください。
エネルギーは-78.03171815 hartreeぐらい（数値誤差や収束判定により多少の誤差が出ます）になると思われますので、正しいか確認してください。
きちんと考えているとおりの構造になるでしょうか。
必ずしも構造最適化をしなければならないわけではありません。ケースバイケースです。[^1]

## MOLDENファイルによる可視化

とりあえず、[04_ethylene_c1.input](04_ethylene_c1.input)というインプットファイルを使ったことにしておきましょう（実際には短く、かつ分かりやすい名前にするのが望ましい）。
すると、計算が正しく終了していれば`04_ethylene_c1.scf.molden`というファイルが得られると思います。
これが、ファイルの拡張子から判断して、SCF（すなわちHartree–Fock）により得た分子軌道となります。
ファイルの中身は説明しませんが、分子の構造・電荷・基底関数・分子軌道係数あたりが並んでいるようです。
こうして得られた`04_ethylene_c1.scf.molden`というファイルを[MOLDEN](http://cheminf.cmbi.ru.nl/molden/)や
[Avogadro](https://avogadro.cc/)などの可視化ソフトウェアで読み込むと、可視化することができます。
それぞれの可視化ソフトウェアの使い方はそれほど詳しくないので、試行錯誤してください。

空間対称性を用いる場合は、既約表現ごとに分子軌道が表示されます。
この場合は`++    Molecular orbitals:`から始まる部分をよく見て、どの軌道がどの既約表現に属するかを判断して、
さらにどの軌道が占有・非占有なのかを判断します。
空間対称性を用いる場合の分子軌道も確認して、同じπ軌道とπ\*軌道を見つけてみましょう。

## 初期軌道に使うファイルについて

可視化とは直接関係ありませんが、OpenMolcas内で使う分子軌道のファイルについても説明しておきます。
同じディレクトリに`04_ethylene_c1.ScfOrb`というファイルができていると思います。
これもSCFにより得た分子軌道が書き込まれていますが、こちらは可視化ソフトウェアで使うものではなく、OpenMolcasで分子軌道を読み込ませたり、操作したりするときに用います。

例えば、同じディレクトリに別の名前のインプットファイルを作り、分子の構造を先ほど構造最適化したものにしましょう。
そして、まずはその構造を用いて一点計算をしてみましょう。
私の場合は、SCFの収束まで9サイクルかかりました。
初期軌道を用いない場合は、おそらくヒュッケル法なんかをして初期軌道を推測し、それをもとにしてSCF計算を行います。
推測した初期軌道は必ずしも解に近くはないため、SCFの収束まである程度のサイクルが必要となります。

次に、初期軌道を用いてみましょう。
初期軌道を用いるには、`&SCF`モジュールで`FILEORB`というオプションを使います。
```
&SCF
  FILEORB = 04_ethylene_c1.ScfOrb
```
これで計算をすると、2サイクルで終了しました。
別の計算で得られた解を使ってSCFを解いているので、すぐに収束しているわけです。

MCSCFの場合は特に、基本的には初期軌道を用います。
SCFの初期軌道を用いる場合もあれば、MCSCFで得た初期軌道を用いる場合もあります。
いずれにせよ、このオプションを使えるようになっておきましょう。

## 演習問題

- 同じく、cc-pVDZとaug-cc-pVDZという基底関数を用いて、それぞれethyleneのπ軌道とπ\*軌道をプロットしてみましょう。
cc-pVDZを用いた場合には、先ほどと同じように8番目と9番目の軌道で良いかもしれません。
一方でaug-cc-pVDZの場合は8番目と9番目に対応するかは分かりません。
どのあたりまで軌道をチェックする必要があるでしょうか。
この"aug-" (= augmentation)はdiffuse関数と呼ばれています。
ガウス関数の指数部分が小さい関数（空間的には大きな関数）のことで、
通常は電気陰性度が高い元素に対して用いる傾向が高いです。[^2]
- 同様に、HF/6-31G(d)かHF/cc-pVDZレベルで1,3-butadiene (C<sub>4</sub>H<sub>6</sub>)と1,3,5-hexatriene (C<sub>6</sub>H<sub>8</sub>)のπ軌道とπ\*軌道をプロットしてみましょう。
すべてE体？（trans体？ジグザグ？）で良いです。
- Re<sub>2</sub>Cl<sub>8</sub><sup>2-</sup>のδ結合を発見できるか試してみましょう。基底関数は、とりあえずLanL2DZとかが良いと思います。

エチレンを含め、ここでの結果は次回以降のMCSCFでも使う予定です。

---
[^1]: 一点計算をしたり、既に別の手法で構造最適化をしている場合は、Hartree–Fockによる構造最適化の必要はないです。
[^2]: が、計算コストは増えるうえに、特にMCSCFの場合は活性空間を作るのが難しくなる場合が多いので、あまり嬉しくない。実際、MCSCFの場合はあまりdiffuse関数は使われない模様。
